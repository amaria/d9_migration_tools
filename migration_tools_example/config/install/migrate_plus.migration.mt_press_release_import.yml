# This migration demonstrates importing from an HTML file using obtainers / modifier jobs.
id: mt_press_release_import
label: Migration Tools Press Release Import Example
migration_group: migration_tools_example
source:
  plugin: url_list

  # Field from source plugin that will contain the URL to fetch.
  field_containing_url: url

  # Optional, field from source plugin that will contain the HTML already fetched.
  #field_containing_url: html

  # @todo Allow modifier class override
  #modifier_class: '\Drupal\custom_migration_module\Modifier\CustomModifyHtml'

  urls:
    - https://www.drupal.org/about
    - https://www.drupal.org/community
  fields:
    -
      name: alt_title
      label: 'Title'
      obtainer: ObtainTitle
      jobs:
        - { job: 'addSearch', method: 'pluckSelector', arguments: [ 'h1', 1 ] }
        - { job: 'addSearch', method: 'pluckSelector', arguments: [ 'title', 1 ] }
    -
      name: date_updated_reviewed
      label: 'Date Updated / Reviewed'
      obtainer: ObtainDate
      jobs:
        - { job: 'addSearch', method: 'pluckAndFilterForwardDate', arguments: [ 'h1', 1 ] }
        - { job: 'addSearch', method: 'pluckSelector', arguments: [ 'title', 1 ] }
  modifiers:
    - { method: 'removeSelectorAll', arguments: [ '.topnavlinks' ] }
    - { method: 'removeEmptyTables' }
  html_elements_to_remove: [ '.pagedate', 'head' ]

process:
  id: title
  title: title
  changed: date_updated_reviewed

destination:
  plugin: 'entity:node'

migration_dependencies: {}
dependencies:
  enforced:
    module:
      - migration_tools_example
